# Create dataframe with counts of ICD codes and diagnoses

# count_icd9 <- puf_pad_grninf_clean %>% group_by(podiag, podiagtx) %>% summarise(count = n())
# count_icd10 <- puf_pad_grninf_clean %>% group_by(podiag10, podiagtx10) %>% summarise(count = n())

# Create a vector for the relevant ICD-9 and ICD-10 codes for peripheral arterial disease 
# copied from the CIPHER phenotypes - https://phenomics.va.ornl.gov/web/cipher/phenotype-viewer?uqid=acbc48f5da604934b39561ce6e20a5c7&name=Peripheral_Artery_Disease__ICD_based__MVP_

pad_icd9 <- c(250.71, 250.72, 250.73, 440.2, 440.21, 440.22, 440.23, 440.24, 440.29, 440.31, 440.32, 440.4, 440.9, 443.9, 444.22, 444.81, 444.89, 445.02, 447.1, 459.9, 707.1, 707.11, 707.12, 707.13, 707.14, 707.15, 707.19, 785.4)
pad_icd9 <- as.character(pad_icd9)

icd10_values <- "E08.52, E09.52, E10.51, E10.52, E10.59, E11.51, E11.52, E11.59, E13.51, E13.52, E13.59, I70.0, I70.201, I70.202, I70.203, I70.208, I70.209, I70.211, I70.212, I70.213, I70.218, I70.219, I70.221, I70.222, I70.223, I70.228, I70.229, I70.231, I70.232, I70.233, I70.234, I70.235, I70.238, I70.239, I70.241, I70.242, I70.243, I70.244, I70.245, I70.248, I70.249, I70.25, I70.261, I70.262, I70.263, I70.268, I70.269, I70.291, I70.292, I70.293, I70.298, I70.299, I70.301, I70.302, I70.303, I70.308, I70.309, I70.311, I70.312, I70.313, I70.318, I70.319, I70.321, I70.322, I70.323, I70.328, I70.329, I70.331, I70.332, I70.333, I70.334, I70.335, I70.338, I70.339, I70.341, I70.342, I70.343, I70.344, I70.345, I70.348, I70.349, I70.35, I70.361, I70.362, I70.363, I70.368, I70.369, I70.391, I70.392, I70.393, I70.398, I70.399, I70.401, I70.402, I70.403, I70.408, I70.409, I70.411, I70.412, I70.413, I70.418, I70.419, I70.421, I70.422, I70.423, I70.428, I70.429, I70.431, I70.432, I70.433, I70.434, I70.435, I70.438, I70.439, I70.441, I70.442, I70.443, I70.444, I70.445, I70.448, I70.449, I70.45, I70.461, I70.462, I70.463, I70.468, I70.469, I70.491, I70.492, I70.493, I70.498, I70.499, I70.501, I70.502, I70.503, I70.508, I70.509, I70.511, I70.512, I70.513, I70.518, I70.519, I70.521, I70.522, I70.523, I70.528, I70.529, I70.531, I70.532, I70.533, I70.534, I70.535, I70.538, I70.539, I70.541, I70.542, I70.543, I70.544, I70.545, I70.548, I70.549, I70.55, I70.561, I70.562, I70.563, I70.568, I70.569, I70.591, I70.592, I70.593, I70.598, I70.599, I70.601, I70.602, I70.603, I70.608, I70.609, I70.611, I70.612, I70.613, I70.618, I70.619, I70.621, I70.622, I70.623, I70.628, I70.629, I70.631, I70.632, I70.633, I70.634, I70.635, I70.638, I70.639, I70.641, I70.642, I70.643, I70.644, I70.645, I70.648, I70.649, I70.65, I70.662, I70.663, I70.668, I70.669, I70.691, I70.692, I70.693, I70.698, I70.699, I70.701, I70.702, I70.703, I70.708, I70.709, I70.711, I70.712, I70.713, I70.718, I70.719, I70.721, I70.722, I70.723, I70.728, I70.729, I70.731, I70.732, I70.733, I70.734, I70.735, I70.738, I70.739, I70.741, I70.742, I70.743, I70.744, I70.745, I70.748, I70.749, I70.75, I70.762, I70.763, I70.768, I70.769, I70.791, I70.792, I70.793, I70.798, I70.799, I70.90, I70.91, I70.92, I73.9, I74.01, I74.09, I74.10, I74.19, I74.3, I74.4, I74.5, I74.8, I75.021, I75.022, I75.023, I75.029, I77.1, I96., L97.101, L97.102, L97.103, L97.104, L97.109, L97.111, L97.112, L97.113, L97.114, L97.119, L97.121, L97.122, L97.123, L97.124, L97.129, L97.201, L97.202, L97.203, L97.204, L97.209, L97.211, L97.212, L97.213, L97.214, L97.219, L97.221, L97.222, L97.223, L97.224, L97.229, L97.301, L97.302, L97.303, L97.304, L97.309, L97.311, L97.312, L97.313, L97.314, L97.319, L97.321, L97.322, L97.323, L97.324, L97.329, L97.401, L97.402, L97.403, L97.404, L97.409, L97.411, L97.412, L97.413, L97.414, L97.419, L97.421, L97.422, L97.423, L97.424, L97.429, L97.501, L97.502, L97.503, L97.504, L97.509, L97.511, L97.512, L97.513, L97.514, L97.519, L97.521, L97.522, L97.523, L97.524, L97.529, L97.801, L97.802, L97.803, L97.804, L97.809, L97.811, L97.812, L97.813, L97.814, L97.819, L97.821, L97.824, L97.829, L97.901, L97.902, L97.903, L97.904, L97.909, L97.911, L97.912, L97.913, L97.914, L97.919, L97.921, L97.922, L97.923, L97.924, L97.929, L97.822, L97.823, I70.661, I70.761"

pad_icd10 <- strsplit(icd10_values, ", ")[[1]]

icd_claudication <- c("440.21", 
                      "I70.211", "I70.212", "I70.213", "I70.218", "I70.219", 
                      "I70.311", "I70.312", "I70.313", "I70.318", "I70.319",
                      "I70.411", "I70.412", "I70.413", "I70.418",
                      "I70.511", "I70.512", "I70.513", "I70.518",
                      "I70.611", "I70.612", "I70.613", "I70.618", "I70.619",
                      "I70.711", "I70.712", "I70.713")

icd_rest_pain <- c("440.22", 
                   "I70.221", "I70.222", "I70.223", "I70.228", "I70.229",
                   "I70.321", "I70.322", "I70.323", "I70.328", "I70.329",
                   "I70.421", "I70.422", "I70.423",
                   "I70.521", "I70.522", "I70.523",
                   "I70.621", "I70.622", "I70.623", "I70.628",
                   "I70.721", "I70.722", "I70.723")

icd_tissue <- c("440.23", "440.24", 
                "707.1", "707.12", "707.13", "707.14", "707.15", "707.19", "785.4", 
                "E10.52", "E11.52", 
                "I70.231", "I70.232", "I70.233", "I70.234", "I70.235", "I70.238", "I70.239", 
                "I70.241", "I70.242", "I70.243", "I70.244", "I70.245", "I70.248", "I70.249", 
                "I70.25", 
                "I70.261", "I70.262", "I70.263", "I70.268", "I70.269",
                "I70.333", "I70.334", "I70.335", "I70.338", "I70.339",
                "I70.342", "I70.343", "I70.344", "I70.345", "I70.348", "I70.349",
                "I70.35",
                "I70.361", "I70.362", "I70.363", "I70.368",
                "I70.432", "I70.433", "I70.434", "I70.435", "I70.438",
                "I70.442", "I70.443", "I70.444", "I70.445", "I70.448", "I70.449",
                "I70.461", "I70.462", "I70.462", "I70.469",
                "I70.535", "I70.538",
                "I70.541", "I70.543", "I70.544", "I70.545",
                "I70.55",
                "I70.561", "I70.562", "I70.563",
                "I70.632", "I70.634", "I70.635", "I70.638", "I70.639",
                "I70.644", "I70.645", "I70.648", "I70.649",
                "I70.661", "I70.662",
                "I70.732", "I70.733", "I70.735", "I70.738", "I70.739",
                "I70.741", "I70.745", "I70.748", "I70.749",
                "I70.75",
                "I70.761", "I70.762", "I70.763", "I70.768",
                "L97.209", "L97.219", "L97.309", "L97.314", "L97.319",
                "L97.321", "L97.322", "L97.329", "L97.409", "L97.412", "L97.413",
                "L97.419", "L97.421", "L97.422", "L97.423", "L97.424", "L97.423",
                "L97.424", "L97.429", "L97.501", "L97.503", "L97.509", "L97.511",
                "L97.512", "L97.513", "L97.514", "L97.519", "L97.521", "L97.522",
                "L97.523", "L97.524", "L97.529", "L97.819", "L97.822", "L97.823",
                "L97.829", "L97.902", "L97.909", "L97.911", "L97.912", "L97.913",
                "L97.919", "L97.921", "L97.922", "L97.929"
                )

icd_embo <- c("444.22", "444.81", "444.89", "445.02",
              "I74.01", "I74.09", "I74.10", "I74.19", "I74.3", "I74.4", "I74.5", "I74.8",
              "I75.021", "I75.022", "I75.023", "I75.029")

icd_prrevasc <- c("I70.301", "I70.302", "I70.303", "I70.309", 
                  "I70.311", "I70.312", "I70.313", "I70.318", "I70.319", 
                  "I70.321", "I70.322", "I70.323", "I70.328", "I70.329",
                  "I70.333", "I70.334", "I70.335", "I70.338", "I70.339",
                  "I70.342", "I70.343", "I70.344", "I70.345", "I70.348", "I70.349",
                  "I70.35",
                  "I70.361", "I70.362", "I70.363", "I70.368",
                  "I70.391", "I70.392", "I70.393", "I70.399", 
                  "I70.401", "I70.402", "I70.403",
                  "I70.411", "I70.412", "I70.413", "I70.418",
                  "I70.421", "I70.422", "I70.423",
                  "I70.432", "I70.433", "I70.434", "I70.435", "I70.438",
                  "I70.442", "I70.443", "I70.444", "I70.445", "I70.448", "I70.449",
                  "I70.461", "I70.462", "I70.462", "I70.469",
                  "I70.491", "I70.492", "I70.499",
                  "I70.501", "I70.502", "I70.503",
                  "I70.511", "I70.512", "I70.513", "I70.518",
                  "I70.521", "I70.522", "I70.523",
                  "I70.535", "I70.538",
                  "I70.541", "I70.543", "I70.544", "I70.545",
                  "I70.55",
                  "I70.561", "I70.562", "I70.563",
                  "I70.592",
                  "I70.601", "I70.602", "I70.603",
                  "I70.611", "I70.612", "I70.613", "I70.618", "I70.619",
                  "I70.621", "I70.622", "I70.623", "I70.628",
                  "I70.632", "I70.634", "I70.635", "I70.638", "I70.639",
                  "I70.644", "I70.645", "I70.648", "I70.649",
                  "I70.661", "I70.662",
                  "I70.691", "I70.692", "I70.693",
                  "I70.701", "I70.702", "I70.708",
                  "I70.711", "I70.712", "I70.713",
                  "I70.721", "I70.722", "I70.723",
                  "I70.732", "I70.733", "I70.735", "I70.738", "I70.739",
                  "I70.741", "I70.745", "I70.748", "I70.749",
                  "I70.75",
                  "I70.761", "I70.762", "I70.763", "I70.768",
                  "I70.791", "I70.792", "I70.793")

# Codes from "Suzuki H, Vaughan-Sarrazin M, Ohl M, Mecham B, McCoy K, Brennan MB, et al. 
# Facility-Level Variation in Major Leg Amputation Among Patients With Newly Diagnosed 
# Diabetic Foot Ulcer. JAMA Netw Open. 2025 Apr 23;8(4):e256781. 


icd_dfu <- c("E08.621", "E09.621", "E10.621", "E11.621", "E13.621", "L97.3", "L97.4", "L97.5",
            "E08", "E09", "E011", "E012", "E013")

icd_osteo <- c("L97.304", "L97.306", "L97.314", "L97.316", "L97.324", "L97.326", "L97.404", 
               "L97.406", "L97.414", "L97.416", "L97.424", "L97.426", "L97.504", "L97.506", 
               "L97.514", "L97.516", "L97.524", "L97.526", "M86.17", "M86.27", "M86.37", "M86.47", 
               "M86.67", "M86.8X7")

icd_gang <- c("E08.52", "E09.52", "E10.52", "E11.52", "E13.52", 
               "A48.0", "I70.269", "I96", "E08.51", "E09.51", "E10.51", "E11.51", "E13.51")

